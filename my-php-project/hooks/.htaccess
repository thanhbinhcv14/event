# Allow direct access to webhook files
# This ensures webhook endpoints can be accessed from external services

<Files "*.php">
    Order allow,deny
    Allow from all
</Files>

# Disable directory listing
Options -Indexes

# Allow POST requests (required for webhooks)
<Limit POST>
    Order allow,deny
    Allow from all
</Limit>

# ✅ QUAN TRỌNG: Đảm bảo Authorization header được pass qua đúng cách
# Một số server (đặc biệt là Apache) có thể không pass Authorization header mặc định
# Cần enable mod_rewrite và setenvif để pass header này

# Set environment variable từ Authorization header (nếu mod_setenvif có sẵn)
<IfModule mod_setenvif.c>
    SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1
</IfModule>

# Hoặc dùng mod_rewrite để pass Authorization header (nếu mod_rewrite có sẵn)
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTP:Authorization} ^(.*)
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%1]
</IfModule>

